[{"id":"53a4d32a120d2c58","type":"tab","label":"Hot Cold (Context)","disabled":false,"info":"","env":[]},{"id":"c6c7d5eb060dc596","type":"group","z":"53a4d32a120d2c58","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["64a44e724789eba8","428dccc1b3707fcc"],"x":354,"y":279,"w":192,"h":142},{"id":"fa05d669695e8abe","type":"group","z":"53a4d32a120d2c58","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["d51ac8d4f822e03e","cb726091fa081cfe"],"x":614,"y":279,"w":192,"h":142},{"id":"ef58ccddfcaa7c37","type":"context-init","z":"53a4d32a120d2c58","name":"","format":"javascript","template":"// Add entities\nctx.populateContext([\n  ctx.Entity('r1', 'room', { subtype: 'kitchen' }),\n  // ctx.Entity('r2', 'room', { subtype: 'bedroom' }),\n  // ctx.Entity('r3', 'room', { subtype: 'bathroom' }),\n  ctx.Entity('night', 'system', { on: false })\n]);\n\n// Specifies the contexts/layers preconditions\nctx.registerQuery('Night',\n  function (entity) {\n    return entity.id == 'night' && entity.on\n  })\nctx.registerQuery('Room.WithTaps',\n  function (entity) {\n    return entity.type == 'room' &&\n      entity.subtype == 'kitchen' || entity.subtype == 'bathroom'\n  })\n\n// Specify the effect of certain events on the context\nctx.registerEffect('Time', function (data) {\n  if(data.Time==\"08:00\") {\n    ctx.getEntityById('night').on = false\n  } else if (data.Time == \"21:00\") {\n    ctx.getEntityById('night').on = true\n  }\n})\n\nctx.registerQuery('Room.Kitchen',\n  function (entity) {\n    return entity.type == 'room' &&\n      'kitchen' == entity.subtype\n  })","x":160,"y":60,"wires":[]},{"id":"f97848098db6dc08","type":"context-start","z":"53a4d32a120d2c58","name":"","context":"Room.WithTaps","quantity":"all","x":190,"y":200,"wires":[["5ebfa4280ba535dc","04d43f916f180798"]]},{"id":"5ebfa4280ba535dc","type":"loop","z":"53a4d32a120d2c58","name":"","list":"","from":"0","skip":"1","to":"3","x":430,"y":200,"wires":[["7ad39d3d719c8764"],[]]},{"id":"04d43f916f180798","type":"ColdRoom","z":"53a4d32a120d2c58","internalFields":"[\"roomID\"]","roomID":"","roomIDType":"str","roomIDR":"context.entity.id","roomIDRType":"msg","name":"","eventType":"request","x":450,"y":140,"wires":[["046b46565bb2d56f"]]},{"id":"046b46565bb2d56f","type":"ColdRoom","z":"53a4d32a120d2c58","internalFields":"[\"roomID\"]","roomID":"","roomIDType":"str","roomIDR":"context.entity.id","roomIDRType":"msg","name":"","eventType":"request","x":630,"y":140,"wires":[["2d9b71ac3a118453"]]},{"id":"2d9b71ac3a118453","type":"ColdRoom","z":"53a4d32a120d2c58","internalFields":"[\"roomID\"]","roomID":"","roomIDType":"str","roomIDR":"context.entity.id","roomIDRType":"msg","name":"","eventType":"request","x":810,"y":140,"wires":[[]]},{"id":"7ad39d3d719c8764","type":"HotRoom","z":"53a4d32a120d2c58","internalFields":"[\"roomID\"]","roomID":"","roomIDType":"str","roomIDR":"context.entity.id","roomIDRType":"msg","name":"","eventType":"request","x":600,"y":200,"wires":[["5ebfa4280ba535dc"]]},{"id":"f44a69d7335b0444","type":"context-start","z":"53a4d32a120d2c58","name":"","context":"Room.Kitchen","quantity":"all","x":190,"y":360,"wires":[["428dccc1b3707fcc"]]},{"id":"428dccc1b3707fcc","type":"ColdRoom","z":"53a4d32a120d2c58","g":"c6c7d5eb060dc596","internalFields":"[\"roomID\"]","roomID":"context.entity.id","roomIDType":"msg","roomIDR":"tmp","roomIDRType":"msg","name":"","eventType":"waitFor","x":450,"y":320,"wires":[["d51ac8d4f822e03e"]]},{"id":"64a44e724789eba8","type":"HotRoom","z":"53a4d32a120d2c58","g":"c6c7d5eb060dc596","internalFields":"[\"roomID\"]","roomID":"context.entity.id","roomIDType":"msg","roomIDR":"tmp","roomIDRType":"msg","name":"","eventType":"block","x":440,"y":380,"wires":[[]]},{"id":"d51ac8d4f822e03e","type":"HotRoom","z":"53a4d32a120d2c58","g":"fa05d669695e8abe","internalFields":"[\"roomID\"]","roomID":"context.entity.id","roomIDType":"msg","roomIDR":"tmp","roomIDRType":"msg","name":"","eventType":"waitFor","x":700,"y":380,"wires":[["428dccc1b3707fcc"]]},{"id":"cb726091fa081cfe","type":"ColdRoom","z":"53a4d32a120d2c58","g":"fa05d669695e8abe","internalFields":"[\"roomID\"]","roomID":"context.entity.id","roomIDType":"msg","roomIDR":"tmp","roomIDRType":"msg","name":"","eventType":"block","x":710,"y":320,"wires":[[]]},{"id":"d8e988ed4670d137","type":"context-start","z":"53a4d32a120d2c58","name":"","context":"Night","quantity":"all","x":160,"y":480,"wires":[["d928403eee49c085"]]},{"id":"84c2e9a74aa5aa9c","type":"start","z":"53a4d32a120d2c58","name":"","x":150,"y":560,"wires":[["350587d738777e92","013274b54e9a8003"]]},{"id":"350587d738777e92","type":"loop","z":"53a4d32a120d2c58","name":"","list":"","from":"0","skip":"1","to":"3","x":330,"y":560,"wires":[["4344db48fd53e3f7"],[]]},{"id":"013274b54e9a8003","type":"loop","z":"53a4d32a120d2c58","name":"","list":"","from":"0","skip":"1","to":"5","x":330,"y":640,"wires":[["184473412f15a3fa"],[]]},{"id":"d928403eee49c085","type":"Vacuum","z":"53a4d32a120d2c58","internalFields":"[]","name":"","eventType":"block","x":340,"y":480,"wires":[[]]},{"id":"184473412f15a3fa","type":"Vacuum","z":"53a4d32a120d2c58","internalFields":"[]","name":"","eventType":"block","x":520,"y":640,"wires":[["013274b54e9a8003"]]},{"id":"4344db48fd53e3f7","type":"Time","z":"53a4d32a120d2c58","internalFields":"[\"time\"]","time":"","timeType":"str","timeR":"8:00","timeRType":"str","name":"Time (8am)","eventType":"request","x":510,"y":560,"wires":[["b8f9eed21991b551"]]},{"id":"b8f9eed21991b551","type":"Time","z":"53a4d32a120d2c58","internalFields":"[\"time\"]","time":"","timeType":"str","timeR":"21:00","timeRType":"str","name":"Time (9pm)","eventType":"request","x":710,"y":560,"wires":[["350587d738777e92"]]}]