[{"id":"c18fe26df1878e0d","type":"tab","label":"Hot Cold (Context)","disabled":false,"info":""},{"id":"884258c3b5789e6a","type":"group","z":"c18fe26df1878e0d","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["3051d7c3bfd3fd24","9ed94c930aed040b"],"x":334,"y":299,"w":192,"h":142},{"id":"c8bdc958bf312a7f","type":"group","z":"c18fe26df1878e0d","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["313b78292ed71c0d","1ec041919b243cdf"],"x":614,"y":299,"w":192,"h":142},{"id":"58f5ec6350362988","type":"loop","z":"c18fe26df1878e0d","name":"","list":"","from":"0","skip":"1","to":"3","x":370,"y":180,"wires":[["43da5d296ab12848"],[]]},{"id":"1e02a8fe403ee6cd","type":"comment","z":"c18fe26df1878e0d","name":"Interleave","info":"","x":140,"y":300,"wires":[]},{"id":"5059fde11057aa17","type":"context-init","z":"c18fe26df1878e0d","name":"","format":"javascript","template":"// Add entities\nctx.populateContext([\n  ctx.Entity('r1', 'room', { subtype: 'kitchen' }),\n  // ctx.Entity('r2', 'room', { subtype: 'bedroom' }),\n  // ctx.Entity('r3', 'room', { subtype: 'bathroom' }),\n  ctx.Entity('night', 'system', { on: false })\n]);\n\n// Specifies the contexts/layers preconditions\nctx.registerQuery('Night',\n  function (entity) {\n    return entity.id == 'night' && entity.on\n  })\nctx.registerQuery('Room.WithTaps',\n  function (entity) {\n    return entity.type == 'room' &&\n      entity.subtype == 'kitchen' || entity.subtype == 'bathroom'\n  })\n\n// Specify the effect of certain events on the context\nctx.registerEffect('Time', function (data) {\n  if(data.time==\"8:00\") {\n    ctx.getEntityById('night').on = false\n  } else if (data.time == \"21:00\") {\n    ctx.getEntityById('night').on = true\n  }\n})\n\nctx.registerQuery('Room.Kitchen',\n  function (entity) {\n    return entity.type == 'room' &&\n      'kitchen' == entity.subtype\n  })","x":140,"y":60,"wires":[]},{"id":"3c9e173ce68bf50d","type":"context-start","z":"c18fe26df1878e0d","name":"","context":"Room.WithTaps","quantity":"all","x":170,"y":140,"wires":[["58f5ec6350362988","bc887ac46788763f"]]},{"id":"f7d2cd07c8d2aebe","type":"context-start","z":"c18fe26df1878e0d","name":"","context":"Room.Kitchen","quantity":"all","x":170,"y":340,"wires":[["3051d7c3bfd3fd24"]]},{"id":"bc887ac46788763f","type":"ColdRoom","z":"c18fe26df1878e0d","internalFields":"[\"roomID\"]","roomID":"context.entity.id","roomIDType":"msg","name":"","eventType":"request","x":410,"y":100,"wires":[["069bf5a8f2d7a8c1"]]},{"id":"069bf5a8f2d7a8c1","type":"ColdRoom","z":"c18fe26df1878e0d","internalFields":"[\"roomID\"]","roomID":"context.entity.id","roomIDType":"msg","name":"","eventType":"request","x":590,"y":100,"wires":[["624d149f60d0e658"]]},{"id":"624d149f60d0e658","type":"ColdRoom","z":"c18fe26df1878e0d","internalFields":"[\"roomID\"]","roomID":"context.entity.id","roomIDType":"msg","name":"","eventType":"request","x":770,"y":100,"wires":[[]]},{"id":"43da5d296ab12848","type":"HotRoom","z":"c18fe26df1878e0d","internalFields":"[\"roomID\"]","roomID":"context.entity.id","roomIDType":"msg","name":"","eventType":"request","x":540,"y":180,"wires":[["58f5ec6350362988"]]},{"id":"3051d7c3bfd3fd24","type":"ColdRoom","z":"c18fe26df1878e0d","g":"884258c3b5789e6a","internalFields":"[\"roomID\"]","roomID":"context.entity.id","roomIDType":"msg","name":"","eventType":"waitFor","x":430,"y":340,"wires":[["1ec041919b243cdf"]]},{"id":"313b78292ed71c0d","type":"ColdRoom","z":"c18fe26df1878e0d","g":"c8bdc958bf312a7f","internalFields":"[\"roomID\"]","roomID":"context.entity.id","roomIDType":"msg","name":"","eventType":"block","x":710,"y":340,"wires":[[]]},{"id":"9ed94c930aed040b","type":"HotRoom","z":"c18fe26df1878e0d","g":"884258c3b5789e6a","internalFields":"[\"roomID\"]","roomID":"context.entity.id","roomIDType":"msg","name":"","eventType":"block","x":420,"y":400,"wires":[[]]},{"id":"1ec041919b243cdf","type":"HotRoom","z":"c18fe26df1878e0d","g":"c8bdc958bf312a7f","internalFields":"[\"roomID\"]","roomID":"context.entity.id","roomIDType":"msg","name":"","eventType":"waitFor","x":700,"y":400,"wires":[["3051d7c3bfd3fd24"]]},{"id":"a4f595470acca4e4","type":"start","z":"c18fe26df1878e0d","name":"","x":150,"y":620,"wires":[["801a666d7dd08e02","9966d2c6b066ce93"]]},{"id":"801a666d7dd08e02","type":"Time","z":"c18fe26df1878e0d","internalFields":"[\"time\"]","time":"8:00","timeType":"str","name":"Time (8am)","eventType":"request","x":370,"y":620,"wires":[["48e934a01ae753a4"]]},{"id":"48e934a01ae753a4","type":"Time","z":"c18fe26df1878e0d","internalFields":"[\"time\"]","time":"21:00","timeType":"str","name":"Time (9pm)","eventType":"request","x":550,"y":620,"wires":[["e0d13ab84c9702a1"]]},{"id":"3f420e9bde22c3ef","type":"Vacuum","z":"c18fe26df1878e0d","internalFields":"[]","name":"","eventType":"block","x":360,"y":540,"wires":[[]]},{"id":"03fe7d5151177663","type":"context-start","z":"c18fe26df1878e0d","name":"","context":"Night","quantity":"all","x":140,"y":540,"wires":[["3f420e9bde22c3ef"]]},{"id":"e0d13ab84c9702a1","type":"Time","z":"c18fe26df1878e0d","internalFields":"[\"time\"]","time":"8:00","timeType":"str","name":"Time (8am)","eventType":"request","x":750,"y":620,"wires":[[]]},{"id":"55eefc8c1067842e","type":"Vacuum","z":"c18fe26df1878e0d","internalFields":"[]","name":"","eventType":"request","x":500,"y":720,"wires":[["9966d2c6b066ce93"]]},{"id":"9966d2c6b066ce93","type":"loop","z":"c18fe26df1878e0d","name":"","list":"","from":"0","skip":"1","to":"3","x":350,"y":720,"wires":[["55eefc8c1067842e"],[]]}]