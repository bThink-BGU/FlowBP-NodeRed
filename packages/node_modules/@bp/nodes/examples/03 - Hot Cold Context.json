[{"id":"b4de33a510518889","type":"tab","label":"Hot Cold (Context)","disabled":false,"info":""},{"id":"1df27c276bea956d","type":"group","z":"b4de33a510518889","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["a00c396a8af3969e","b1075fcb1aa37553"],"x":354,"y":299,"w":192,"h":162},{"id":"3c738a47b6e19580","type":"group","z":"b4de33a510518889","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["157defa7045e0e69","846440ab83b8f079"],"x":594,"y":299,"w":192,"h":162},{"id":"e979153ac5e96f1a","type":"loop","z":"b4de33a510518889","name":"","list":"","from":"0","skip":"1","to":"3","x":430,"y":220,"wires":[["f65d0a8802411b99"],[]]},{"id":"096691dbe3b53ac9","type":"comment","z":"b4de33a510518889","name":"Interleave","info":"","x":140,"y":300,"wires":[]},{"id":"893c39952ebb21ba","type":"context-init","z":"b4de33a510518889","name":"","format":"javascript","template":"// Add entities\nctx.populateContext([\n  // ctx.Entity('r1', 'room', { subtype: 'kitchen' }),\n  // ctx.Entity('r2', 'room', { subtype: 'bedroom' }),\n  ctx.Entity('r3', 'room', { subtype: 'bathroom' }),\n  ctx.Entity('night', 'system', { on: false })\n]);\n\n// Specifies the contexts/layers preconditions\nctx.registerQuery('Night',\n  function (entity) {\n    return entity.id == 'night' && entity.on\n  })\nctx.registerQuery('Room.WithTaps',\n  function (entity) {\n    return entity.type == 'room' &&\n      entity.subtype == 'kitchen' || entity.subtype == 'bathroom'\n  })\n\n// Specify the effect of certain events on the context\nctx.registerEffect('time 21:00', function (data) {\n  ctx.getEntityById('night').on = true\n})\nctx.registerEffect('time 08:00', function (data) {\n  ctx.getEntityById('night').on = false\n})\n\nctx.registerQuery('Room.Kitchen',\n  function (entity) {\n    return entity.type == 'room' &&\n      'kitchen' == entity.subtype\n  })","x":140,"y":60,"wires":[]},{"id":"4dd5b959552e3c40","type":"context-start","z":"b4de33a510518889","name":"","context":"Night","quantity":"all","x":160,"y":540,"wires":[["ccb7d766c2df8411"]]},{"id":"ccb7d766c2df8411","type":"Vacuum","z":"b4de33a510518889","name":"","eventType":"block","x":340,"y":540,"wires":[[]]},{"id":"3313e246232f405e","type":"start","z":"b4de33a510518889","name":"","x":150,"y":620,"wires":[["55673e8e92749d4b"]]},{"id":"b72e6f748ae82c81","type":"Time8am","z":"b4de33a510518889","name":"","eventType":"request","x":500,"y":620,"wires":[["f0d2da0e34d1f815"]]},{"id":"f0d2da0e34d1f815","type":"Time9pm","z":"b4de33a510518889","name":"","eventType":"request","x":660,"y":620,"wires":[["55673e8e92749d4b"]]},{"id":"2386befa8fc08da9","type":"context-start","z":"b4de33a510518889","name":"","context":"Room.WithTaps","quantity":"all","x":170,"y":140,"wires":[["e979153ac5e96f1a","beb287fe44b8215e"]]},{"id":"6403531e943b2ad0","type":"context-start","z":"b4de33a510518889","name":"","context":"Room.Kitchen","quantity":"all","x":170,"y":340,"wires":[["a00c396a8af3969e"]]},{"id":"beb287fe44b8215e","type":"ColdRoom","z":"b4de33a510518889","RoomId":"","internalFields":"[{\"name\":\"RoomId\",\"type\":\"text\",\"defaultValue\":\"\"}]","name":"","eventType":"request","x":450,"y":140,"wires":[["00fa42858449ec75"]]},{"id":"00fa42858449ec75","type":"ColdRoom","z":"b4de33a510518889","RoomId":"","internalFields":"[{\"name\":\"RoomId\",\"type\":\"text\",\"defaultValue\":\"\"}]","name":"","eventType":"request","x":610,"y":140,"wires":[["998cfc0db0a43f8a"]]},{"id":"998cfc0db0a43f8a","type":"ColdRoom","z":"b4de33a510518889","RoomId":"","internalFields":"[{\"name\":\"RoomId\",\"type\":\"text\",\"defaultValue\":\"\"}]","name":"","eventType":"request","x":770,"y":140,"wires":[[]]},{"id":"f65d0a8802411b99","type":"HotRoom","z":"b4de33a510518889","RoomId":"","internalFields":"[{\"name\":\"RoomId\",\"type\":\"text\",\"defaultValue\":\"\"}]","name":"","eventType":"request","x":600,"y":220,"wires":[["e979153ac5e96f1a"]]},{"id":"a00c396a8af3969e","type":"ColdRoom","z":"b4de33a510518889","g":"1df27c276bea956d","RoomId":"","internalFields":"[{\"name\":\"RoomId\",\"type\":\"text\",\"defaultValue\":\"\"}]","name":"","eventType":"waitFor","x":450,"y":340,"wires":[["846440ab83b8f079"]]},{"id":"157defa7045e0e69","type":"ColdRoom","z":"b4de33a510518889","g":"3c738a47b6e19580","RoomId":"","internalFields":"[{\"name\":\"RoomId\",\"type\":\"text\",\"defaultValue\":\"\"}]","name":"","eventType":"block","x":690,"y":340,"wires":[[]]},{"id":"b1075fcb1aa37553","type":"HotRoom","z":"b4de33a510518889","g":"1df27c276bea956d","RoomId":"","internalFields":"[{\"name\":\"RoomId\",\"type\":\"text\",\"defaultValue\":\"\"}]","name":"","eventType":"block","x":440,"y":420,"wires":[[]]},{"id":"846440ab83b8f079","type":"HotRoom","z":"b4de33a510518889","g":"3c738a47b6e19580","RoomId":"","internalFields":"[{\"name\":\"RoomId\",\"type\":\"text\",\"defaultValue\":\"\"}]","name":"","eventType":"waitFor","x":680,"y":420,"wires":[["a00c396a8af3969e"]]},{"id":"55673e8e92749d4b","type":"loop","z":"b4de33a510518889","name":"","list":"","from":"0","skip":"1","to":"3","x":330,"y":620,"wires":[["b72e6f748ae82c81"],[]]}]