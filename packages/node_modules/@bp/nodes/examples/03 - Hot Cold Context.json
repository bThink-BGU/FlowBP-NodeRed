[{"id":"c18fe26df1878e0d","type":"tab","label":"Hot Cold (Context)","disabled":false,"info":""},{"id":"884258c3b5789e6a","type":"group","z":"c18fe26df1878e0d","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["c74311dccdc0ef0d","d913d8de934f3a46"],"x":334,"y":279,"w":192,"h":142},{"id":"c8bdc958bf312a7f","type":"group","z":"c18fe26df1878e0d","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["54b57f1853efe0a4","cdd3ff4d6702ece6"],"x":594,"y":279,"w":192,"h":142},{"id":"58f5ec6350362988","type":"loop","z":"c18fe26df1878e0d","name":"","list":"","from":"0","skip":"1","to":"3","x":370,"y":180,"wires":[["be6a1b76310ee048"],[]]},{"id":"1e02a8fe403ee6cd","type":"comment","z":"c18fe26df1878e0d","name":"Interleave","info":"","x":140,"y":300,"wires":[]},{"id":"5059fde11057aa17","type":"context-init","z":"c18fe26df1878e0d","name":"","format":"javascript","template":"// Add entities\nctx.populateContext([\n  ctx.Entity('r1', 'room', { subtype: 'kitchen' }),\n  // ctx.Entity('r2', 'room', { subtype: 'bedroom' }),\n  ctx.Entity('r3', 'room', { subtype: 'bathroom' }),\n  ctx.Entity('night', 'system', { on: false })\n]);\n\n// Specifies the contexts/layers preconditions\nctx.registerQuery('Night',\n  function (entity) {\n    return entity.id == 'night' && entity.on\n  })\nctx.registerQuery('Room.WithTaps',\n  function (entity) {\n    return entity.type == 'room' &&\n      entity.subtype == 'kitchen' || entity.subtype == 'bathroom'\n  })\n\n// Specify the effect of certain events on the context\nctx.registerEffect('Time', function (data) {\n  if(data.Time==\"08:00\") {\n    ctx.getEntityById('night').on = false\n  } else if (data.Time == \"21:00\") {\n    ctx.getEntityById('night').on = true\n  }\n})\n\nctx.registerQuery('Room.Kitchen',\n  function (entity) {\n    return entity.type == 'room' &&\n      'kitchen' == entity.subtype\n  })","x":140,"y":60,"wires":[]},{"id":"3c9e173ce68bf50d","type":"context-start","z":"c18fe26df1878e0d","name":"","context":"Room.WithTaps","quantity":"all","x":170,"y":140,"wires":[["4af2ddd21018d357","58f5ec6350362988"]]},{"id":"f7d2cd07c8d2aebe","type":"context-start","z":"c18fe26df1878e0d","name":"","context":"Room.Kitchen","quantity":"all","x":170,"y":340,"wires":[["c74311dccdc0ef0d"]]},{"id":"976833ccefb00aaf","type":"context-start","z":"c18fe26df1878e0d","name":"","context":"Night","quantity":"all","x":160,"y":540,"wires":[["fd5a08d19b28afa3"]]},{"id":"9f362374ebfc3f9f","type":"start","z":"c18fe26df1878e0d","name":"","x":150,"y":620,"wires":[["51f36daa1769918a","803d41064f2b560f"]]},{"id":"51f36daa1769918a","type":"loop","z":"c18fe26df1878e0d","name":"","list":"","from":"0","skip":"1","to":"3","x":330,"y":620,"wires":[["e7c027685224979b"],[]]},{"id":"803d41064f2b560f","type":"loop","z":"c18fe26df1878e0d","name":"","list":"","from":"0","skip":"1","to":"5","x":350,"y":780,"wires":[["ad841486b4abbb1f"],[]]},{"id":"4af2ddd21018d357","type":"ColdRoom","z":"c18fe26df1878e0d","internalFields":"[\"roomID\"]","roomID":"context.entity.id","roomIDType":"msg","name":"","eventType":"request","x":390,"y":100,"wires":[["17a045a384643711"]]},{"id":"17a045a384643711","type":"ColdRoom","z":"c18fe26df1878e0d","internalFields":"[\"roomID\"]","roomID":"context.entity.id","roomIDType":"msg","name":"","eventType":"request","x":570,"y":100,"wires":[["49e467a025aa10e9"]]},{"id":"49e467a025aa10e9","type":"ColdRoom","z":"c18fe26df1878e0d","internalFields":"[\"roomID\"]","roomID":"context.entity.id","roomIDType":"msg","name":"","eventType":"request","x":750,"y":100,"wires":[[]]},{"id":"be6a1b76310ee048","type":"HotRoom","z":"c18fe26df1878e0d","internalFields":"[\"roomID\"]","roomID":"context.entity.id","roomIDType":"msg","name":"","eventType":"request","x":540,"y":180,"wires":[["58f5ec6350362988"]]},{"id":"c74311dccdc0ef0d","type":"ColdRoom","z":"c18fe26df1878e0d","g":"884258c3b5789e6a","internalFields":"[\"roomID\"]","roomID":"context.entity.id","roomIDType":"msg","name":"","eventType":"waitFor","x":430,"y":320,"wires":[["cdd3ff4d6702ece6"]]},{"id":"d913d8de934f3a46","type":"HotRoom","z":"c18fe26df1878e0d","g":"884258c3b5789e6a","internalFields":"[\"roomID\"]","roomID":"context.entity.id","roomIDType":"msg","name":"","eventType":"block","x":420,"y":380,"wires":[[]]},{"id":"54b57f1853efe0a4","type":"ColdRoom","z":"c18fe26df1878e0d","g":"c8bdc958bf312a7f","internalFields":"[\"roomID\"]","roomID":"context.entity.id","roomIDType":"msg","name":"","eventType":"block","x":690,"y":320,"wires":[[]]},{"id":"cdd3ff4d6702ece6","type":"HotRoom","z":"c18fe26df1878e0d","g":"c8bdc958bf312a7f","internalFields":"[\"roomID\"]","roomID":"context.entity.id","roomIDType":"msg","name":"","eventType":"waitFor","x":680,"y":380,"wires":[["c74311dccdc0ef0d"]]},{"id":"fd5a08d19b28afa3","type":"Vacuum","z":"c18fe26df1878e0d","internalFields":"[]","name":"","eventType":"block","x":360,"y":540,"wires":[[]]},{"id":"ad841486b4abbb1f","type":"Vacuum","z":"c18fe26df1878e0d","internalFields":"[]","name":"","eventType":"request","x":500,"y":780,"wires":[["803d41064f2b560f"]]},{"id":"e7c027685224979b","type":"Time","z":"c18fe26df1878e0d","internalFields":"[\"time\"]","time":"8:00","timeType":"str","name":"Time (8am)","eventType":"request","x":510,"y":620,"wires":[["da457d556ef17f97"]]},{"id":"da457d556ef17f97","type":"Time","z":"c18fe26df1878e0d","internalFields":"[\"time\"]","time":"21:00","timeType":"str","name":"Time (9pm)","eventType":"request","x":690,"y":620,"wires":[[]]}]