<script type="text/html" data-help-name="loop">

</script>

<script type="text/html" data-template-name="loop">

    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span
                data-i18n="node-red:common.label.name"></span></label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]node-red:common.label.name">
    </div>

    <!-- <div class="form-row">
        <label for="node-input-type"><i class="fa fa-tasks"></i> Loop over:</label>
        <select id="node-input-type">
            <option value="numbers">Numbers</option>
            <option value="list">List</option>
        </select>
    </div> -->


    <!-- <div id="list-details">
        <div class="form-row">
            <label for="node-input-list"> List</label>
            <input type="hidden" id="node-input-listType">
            <input style="width:70%" type="text" id="node-input-list" placeholder="1">
        </div>
    </div> -->

    <div id="numbers-details">
        <div class="form-row">
            <label for="node-input-from"> From</label>
            <input type="hidden" id="node-input-fromType">
            <input style="width:70%" type="text" id="node-input-from" placeholder="1">
        </div>

        <div class="form-row">
            <label for="node-input-skip"> Skip</label>
            <input type="hidden" id="node-input-skipType">
            <input style="width:70%" type="text" id="node-input-skip" placeholder="1">
        </div>
        <div class="form-row">
            <label for="node-input-to"> To</label>
            <input type="hidden" id="node-input-toType">
            <input style="width:70%" type="text" id="node-input-to" placeholder="1">
        </div>
    </div>
</script>


<script type="text/javascript">
  RED.nodes.registerType('loop', {
    category: 'core',
    color: '#d4d4d9',
    defaults: { 
      name: { value: "" },
      list: { value: "" },
      listType: { value: "jsonata" },
      from: { value: "0", required: true, 
        //validate: function (v) { return RED.validators.number(v) && (v >= 0) && (v < this.to); } 
      },
      fromType: { value: "str" },
      skip: { value: "1", required: true, 
        //validate: function (v) { return RED.validators.number(v) && (v >= 1); } 
      },
      skipType: { value: "str" },
      to: { value: 10, required: true, 
        //validate: function (v) { return RED.validators.number(v) && (v > this.from); } 
      },
      toType: { value: "str" },

    },
    inputs: 1,
    outputs: 2,
    icon: "file.png",
    label: function () {
      return this.name || "loop";
    },
    paletteLabel: 'loop',
    outputLabels: ["i<n", "i=n"],
    oneditprepare: function () {
      var node = this;
      // $("#node-input-type").val('numbers');

      // $("#node-input-type").on("change", function () {
      //   if (this.value === "list") {
      //     $("#list-details").show();
      //     $("#numbers-details").hide();
      //   } else if (this.value === "numbers") {
      //     $("#list-details").hide();
      //     $("#numbers-details").show();
      //   }
      // }).trigger("change");



      // $("#node-input-list").typedInput({
      //     default: '[]',
      //     typeField: '#node-input-listType',
      //     types: ['str', 'msg', 'jsonata']
      // });

      $("#node-input-from").typedInput({
          default: '0',
          typeField: '#node-input-fromType',
          types: ['str', 'msg', 'jsonata']
      });
      $("#node-input-skip").typedInput({
          default: '1',
          typeField: '#node-input-skipType',
          types: ['str', 'msg', 'jsonata']
      });


      $("#node-input-to").typedInput({
          default: '10',
          typeField: '#node-input-toType',
          types: ['str', 'msg', 'jsonata']
      });


    }
  });
</script>